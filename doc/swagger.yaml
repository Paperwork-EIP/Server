swagger: '2.0'
info:
  title: Paperwork - API Documentation
  description: Paperwork API documentation for Epitech Project.
  version: 1.0.0
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  contact: 
    name: Paperwork Team
    url: http://eip.epitech.eu/2024/paperwork
    email: paperwork_2024@labeip.epitech.eu
host: 'localhost:8282'
basePath: /
schemes:
  - http
consumes:
  - application/json
produces:
  - application/json
tags:
  - name: user
    description: User management.
  - name: oauth
    description: Oauth management.
  - name: process
    description: Process management.
  - name: step
    description: Step management.
  - name: userProcess
    description: UserProcess management.
  - name: calendar
    description: Calendar management.
  - name: processProposal
    description: ProcessProposal management.
  - name: contact
    description: Contact paperwork.

paths:
  /user/register:
    post:
      parameters:
        - in: body
          name: User
          description: The user to create.
          schema:
            type: object
            required:
              - email
              - username
              - password
            properties:
              email:
                type: string
                example: test@test.test
              username:
                type: string
                example: username
              password:
                type: string
                example: password
              language:
                type: string
                example: english
      responses:
        '200':
          description: User registered.
          schema:
            type: object
            example:
              {
                "message": "User registered !",
                "email": "test@test.com",
                "jwt": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7ImlkIjoyLCJlbWFpbCI6InRlc3RAdGVzdC5jb20ifSwiaWF0IjoxNjcyNzUyMDY2fQ.oAEpSW-SKnhAvmxMnLMVKuMevsRWqF9Y8ar15JNft6U"
              }
        '400':
          description: Pseudo, email or password missing.
        '409':
          description: Username or email already used.
        '500':
          description: System error.
      summary: Register a new user.
      tags:
        - user
  /user/login:
    post:
      parameters:
        - in: body
          name: User
          description: The user to login.
          schema:
            type: object
            required:
              - email
              - password
            properties:
              email:
                type: string
                example: test@test.test
              password:
                type: string
                example: password
      responses:
        '200':
          description: User logged in.
          schema:
            type: object
            example:
              {
                "message": "User logged in !",
                "email": "test@test.test",
                "jwt": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7ImlkIjoyLCJlbWFpbCI6InRlc3RAdGVzdC5jb20ifSwiaWF0IjoxNjcyNzUyMDY2fQ.oAEpSW-SKnhAvmxMnLMVKuMevsRWqF9Y8ar15JNft6U"
              }
        '404':
          description: User does not exist.
        '400':
          description: Email or password missing / invalid email or password.
        '500':
          description: System error.
      summary: Login a user.
      tags:
        - user
  /user/getbyemail:
    get:
      parameters:
        - in: query
          name: email
          description: User email.
          type: string
      responses:
        '200':
          description: User data
          schema:
            type: object
            example:
              {
                "username": "test",
                "email": "test@test.test"
              }
        '400':
          description: Missing parameter email.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Get user information by email.
      tags:
          - user
  /user/getbyusername:
    get:
      parameters:
        - in: query
          name: username
          description: User username.
          type: string
      responses:
        '200':
          description: User data.
          schema:
            type: object
            example:
              {
                "username": "test",
                "email": "test@test.test"
              }
        '400':
          description: Missing parameter username.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Get user information by username.
      tags:
          - user
  /user/getbytoken:
    get:
      parameters:
        - in: query
          name: token
          type: string
          description: User token.
      responses:
        '200':
          description: User data.
          schema:
            type: object
            example:
              {
                "id": 238,
                "username": "test",
                "email": "test@test.test",
                "password": "$2a$10$SE.uo7JNlc8k6aLFuEO6LupENW3MKZ7L4E5kPJLCV5aK4B/b7RQU6",
                "language": null,
                "name": null,
                "firstname": null,
                "adress": null,
                "profile_picture": null,
                "age": null,
                "number_phone": null,
                "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7ImlkIjoyMzgsImVtYWlsIjoidGVzdEB0ZXN0LnRlc3QifSwiaWF0IjoxNjgwMDczMTkwfQ.h-gh-2xjS4KAb_TBVXpQEJZ10K6WF3Jyq5olROTyIJs",
                "google_token": null,
                "facebook_token": null
              }
        '400':
          description: Missing parameter token.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Get all user information by token.
      tags:
          - user
  /user/delete:
    get:
      parameters:
        - in: query
          name: token
          type: string
          description: User token.
      responses:
        '200':
          description: User deleted
        '400':
          description: Missing parameter token.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Delete user.
      tags:
          - user
  /user/modifyDatas:
    post:
      parameters:
        - in: body
          name: User data
          description: The user data to modify.
          schema:
            type: object
            required:
              - token
            properties:
              token:
                type: string
                example: userTokenExemple
              new_email:
                type: string
                example: test@test.test
              password:
                type: string
                example: newPassword
              username:
                type: string
                example: newUsername
              firstname:
                type: string
                example: Emma
              name:
                type: string
                example: lastName
              address:
                type: string
              profile_picture:
                type: string
              number_phone:
                type: integer
                example: 0123456789
      responses:
        '200':
          description: User updated.
        '400':
          description: Missing parameter token.
        '404':
          description: User not found.
        '409':
          description: Email or username already used.
        '500':
          description: System error.
      summary: Modify user data.
      tags:
          - user
  /user/modifySettings:
    get:
      parameters:
        - in: query
          name: token
          type: string
          description: User token.
        - in: query
          name: night_mode
          type: boolean
          description: User preference ( true = night mode, false = light mode).
      responses:
        '200':
          description: User settings updated.
        '400':
          description: Missing parameter token.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Update user's settings.
      tags:
          - user
  /user/sendVerificationEmail:
    get:
      parameters:
        - in: query
          name: token
          type: string
          description: User token.
      responses:
        '200':
          description: Email sent.
        '400':
          description: Missing parameter token.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Send verification email.
      tags:
          - user
  /user/verifyEmail:
    get:
      parameters:
        - in: query
          name: token
          type: string
          description: User token.
        - in: query
          name: code
          type: string
          description: Verification code.
      responses:
        '200':
          description: Email verified.
        '400':
          description: Missing parameter token or code.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Verify email.
      tags:
          - user
  /user/sendResetPasswordEmail:
    get:
      parameters:
        - in: query
          name: email
          type: string
          description: User email.
      responses:
        '200':
          description: Email sent.
          schema:
            type: object
            properties:
              token:
                type: string
                description: User token.
        '400':
          description: Missing parameter email.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Send reset password email.
      tags:
          - user
  /user/resetPassword:
    get:
      parameters:
        - in: query
          name: token
          type: string
          description: User token.
        - in: query
          name: password
          type: string
          description: New password.
      responses:
        '200':
          description: Password reset.
        '400':
          description: Missing parameter token, or password.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Reset password.
      tags:
          - user
  /oauth/google/urlLogin:
    get:
      responses:
        '200':
          description: Link to google connection.
      summary: Return link to google oauth.
      tags:
        - oauth
  /oauth/google/login:
    get:
      parameters:
        - in: query
          name: code
          type: string
          description: The code return by google at the end of the result /oauth/google/urlLogin Paperwork home path.
      responses:
        '200':
          description: Connected with google.
        '500':
          description: Connection with google failed.
      summary: Connect the user with his google account.
      tags:
        - oauth
  /oauth/facebook/url:
    get:
      responses:
        '200':
          description: Link to facebook connection.
      summary: Return link to facebook oauth.
      tags:
        - oauth
  /oauth/facebook/:
    get:
      parameters:
        - in: query
          name: code
          type: string
          description: The code return by facebook at the end of the result /oauth/facebook/url Paperwork home path.
      responses:
        '200':
          description: Connected with facebook.
        '500':
          description: Connection with facebook failed.
      summary: Connect the user with his facebook account.
      tags:
        - oauth
  /process/add:
    post:
      parameters:
        - in: body
          name: Process
          description: Add a process.
          schema:
            type: object
            required:
              - title
            properties:
              title:
                type: string
                example: ProcessTest
              delay:
                type: string
                example: 2022-11-24
                description: Delay of the new process (how long it last), format date "YYYY-MM-DD", it can be NULL.
      responses:
        '200':
          description: Process added.
        '400':
          description: Title or description missing
        '500':
          description: System error.
      summary: Add a process.
      tags:
        - process
  /process/delete:
    get:
      parameters:
        - in: query
          name: title
          type: string
          description: Title of the process.
      responses:
        '200':
          description: Process deleted.
        '400':
          description: Missing parameters.
        '500':
          description: System error.
      summary: Delete a process.
      tags:
        - process
  /process/getAll:
    get:
      parameters:
        - in: query
          name: language
          type: string
          description: Language of the user.
      responses:
        '200':
          description: All existing process.
          schema:
            type: object
            example:
              {
                "response": [
                    {
                        "title": "Vital card",
                        "description": "test",
                        "source": "https://www.service-public.fr/particuliers/vosdroits/F265?lang=en",
                        "stocked_title": "VitalCard"
                    }
                ]
              }
        '500':
          description: System error.
      summary: Get all process.
      tags:
        - process
  /step/add:
    post:
      parameters:
        - in: body
          name: Step
          description: Add a step.
          schema:
            type: object
            required:
              - process_title
            properties:
              process_title:
                type: string
                example: ProcessTitle
                description: Title of the process of the step.
              is_unique:
                type: boolean
                example: false
                description: Tell if the step is mandatory or not.
              delay:
                type: string
                example: 2022-11-24
                description: Delay of the new process (how long it last), format date "YYYY-MM-DD", it can be NULL.
      responses:
        '200':
          description: Step created.
        '400':
          description: Missing parameters.
        '404':
          description: Process not found or no more step to add.
        '500':
          description: System error.
      summary: Add a step to a process.
      tags:
        - step
  /step/deleteall:
    get:
      parameters:
        - in: query
          name: process_title
          type: string
          description: Title of the process where we want to delete all steps.
      responses:
        '200':
          description: Step(s) deleted.
        '400':
          description: Missing parameters.
        '404':
          description: Step(s) not found.
        '500':
          description: System error.
      summary: Delete all steps of a process.
      tags:
        - step
  /processQuestions/get:
    get:
      parameters:
        - in: query
          name: process_title
          type: string
          description: Title  of the process the user want to start.
        - in: query
          name: language
          type: string
          description: Language of the user.
      responses:
        '200':
          description: Process questions.
          schema:
            type: object
            example:
              {
                "questions": [
                  {
                      step_id: 1,
                      question: "stepQuestion1"
                  },
                  {
                      step_id: 2,
                      question: "stepQuestion2"
                  },
                  {
                      step_id: 3,
                      question: "stepQuestion3"
                  }
                ]
              }
        '400':
          description: Missing parameters.
        '404':
          description: Process or Step(s) not found.
        '500':
          description: System error.
      summary: Get process questions.
      tags:
        - question
  /userProcess/add:
    post:
      parameters:
        - in: body
          name: UserProcess
          description: Add a user process.
          schema:
            type: object
            required:
              - user_token
              - process_title
              - questions
            properties:
              process_title:
                type: string
                example: ProcessTitle
                description: Title of the process of the step.
              user_token:
                type: string
                example: userTokenExemple
              questions:
                type: object
                example:
                  [
                    {
                      step_id: id,
                      response: false
                    },
                    ...
                  ]
                description: User responses to the intelligent quizz.
      responses:
        '200':
          description: User process and user steps created.
        '400':
          description: Missing parameters.
        '404':
          description: User not found, process not found or step not found.
        '500':
          description: System error.
      summary: Add a user process.
      tags:
        - userProcess
  /userProcess/update:
    post:
      parameters:
        - in: body
          name: UserProcess
          description: Add a user process.
          schema:
            type: object
            required:
              - user_token
              - process_title
              - questions
            properties:
              process_title:
                type: string
                example: ProcessTitle
                description: Title of the process of the steps to change.
              user_token:
                type: string
                example: userTokenExemple
              questions:
                type: object
                example:
                  [
                    {
                      step_id: id,
                      response: true
                    },
                    ...
                  ]
                description: User steps to update.
      responses:
        '200':
          description: User process and user steps updated.
        '400':
          description: Missing parameters.
        '404':
          description: User not found, process not found, step not found or user process not found.
        '500':
          description: System error.
      summary: Update an user process.
      tags:
        - userProcess
  /userProcess/delete:
    get:
      parameters:
        - in: query
          name: process_title
          type: string
          description: Title of the user process we want to delete.
        - in: query
          name: user_token
          type: string
          description: User token of the user process we want to delete.
      responses:
        '200':
          description: User process and user steps deleted.
        '400':
          description: Missing parameters.
        '404':
          description: User or process not found.
        '500':
          description: System error.
      summary: Delete a user process.
      tags:
        - userProcess
  /userProcess/getUserSteps:
    get:
      parameters:
        - in: query
          name: process_title
          type: string
          description: Process title of the user process.
        - in: query
          name: user_token
          type: string
          description: User token of the user process.
      responses:
        '200':
          description: User steps data.
          schema:
            type: object
            example:
              {
                "message": "User process steps",
                "pourcentage": 33,
                "response":
                [
                  {
                      "id": 1,
                      "step_id": 1,
                      "step_title": "stepTitle1",
                      "step_type": "stepType",
                      "step_description": "stepDescription",
                      "step_source": "stepSource",
                      "is_done": false,
                      "start_date": "2052-12-29T00:00:00.000Z",
                      "end_date": null,
                      "delay": "2052-12-29T00:00:00.000Z",
                      "appoinment": null,
                      "user_process_id": 2
                  },
                  ...
                ]
              }
        '400':
          description: Missing parameters.
        '404':
          description: User or process not found.
        '500':
          description: System error.
      summary: Get user step for a process.
      tags:
        - userProcess
  /userProcess/getUserProcesses:
    get:
      parameters:
        - in: query
          name: user_token
          type: string
          description: User token of the user processes.
      responses:
        '200':
          description: User processes.
          schema:
            type: object
            example:
              {
                "message": "User processes",
                "response": [
                    {
                      "id": 1,
                      "process_id": 1,
                      "title": "Visa long séjour",
                      "description": "ExampleDescription",
                      "source": "link",
                      "stocked_title": "Visa",
                    },
                    ...
                ]
              }
        '400':
          description: Missing parameters.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Get all user processes.
      tags:
        - userProcess
  /calendar/set:
    post:
      parameters:
        - in: body
          name: Calendar set
          description: Set an appointment.
          schema:
            type: object
            required:
              - user_process_id
              - step_id
              - date
            properties:
              user_process_id:
                type: integer
                example: 1
              step_id:
                type: integer
                example: 1
              date:
                type: string
                example: "YYYY-MM-DD HH:mm:ss"
            description: Date and time of the appointment
      responses:
        '200':
            description: Appointment created.
            schema:
              type: object
              example:
                {
                    "message": "Meeting updated!",
                    "response": {
                        "id": 1,
                        "appoinment": "2022-12-01T12:30:00.000Z"
                    }
                }
        '400':
          description: Missing parameters.
        '404':
          description: Step or user process not found.
        '500':
          description: System error.
      summary: Create a new appointment.
      tags:
        - calendar
  /calendar/getAll:
    get:
      parameters:
        - in: query
          name: token
          type: string
          description: Token of the user.
      responses:
        '200':
            description: All the user appointments.
            schema:
              type: object
              example:
                {
                    "message": "User appoinments.",
                    "appoinment": [
                        {
                            "date": "2022-12-01T12:30:00.000Z",
                            "user_process_id": 1,
                            "process_title": "Process title",
                            "step_id": 1,
                            "step_title": "Step title",
                            "step_description": "Description of the step."
                        }
                    ]
                }
        '400':
          description: Missing parameters.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Get all the user appointments.
      tags:
        - calendar
  /calendar/getByPeriod:
    get:
      parameters:
        - in: query
          name: token
          type: string
          description: Token of the user.
        - in: query
          name: date
          type: string
          description: Get all the appointments of the requested period (YYYY-MM-DD or YYYY-MM or YYYY)
      responses:
        '200':
            description: All the user appointments on the requested period of date value.
            schema:
              type: object
              example:
                {
                    "message": "User appoinments.",
                    "appoinment": [
                        {
                            "date": "2022-12-01T12:30:00.000Z",
                            "user_process_id": 1,
                            "process_title": "Process title",
                            "step_id": 1,
                            "step_title": "Step title",
                            "step_description": "Description of the step."
                        }
                    ]
                }
        '400':
          description: Missing parameters.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Get all the user appointmentson a given period.
      tags:
        - calendar
  /calendar/delete:
    get:
      parameters:
        - in: query
          name: user_process_id
          type: integer
          description: Id of the user process linked to the appointment to delete.
        - in: query
          name: step_id
          type: integer
          description: Id of the step linked to the appointment to delete.
      responses:
        '200':
            description: Delete the user appointment.
            schema:
              type: object
              example:
                {
                  "message": "Appoinment deleted.",
                  "res": {
                      "id": 1,
                      "appoinment": null
                  }
                }
        '400':
          description: Missing parameters.
        '404':
          description: User process or step not found.
        '500':
          description: System error.
      summary: Delete an user appointment.
      tags:
        - calendar
  /processProposal/add:
    post:
      parameters:
        - in: body
          name: Process Proposal
          description: Add a process proposal.
          schema:
            type: object
            required:
              - title
              - description
              - content
              - user_token
            properties:
              user_token:
                type: string
                example: UserTokenExemple
              title:
                type: string
                example: Title examole
              description:
                type: string
                example: Description example
              content:
                type: string
                example: Content example
      responses:
        '200':
          description: process proposal created.
          schema:
            type: object
            example:
              {
                "message": "Proposal added.",
                "response": {
                    "id": 1,
                    "title": "..."
                }
              }
        '400':
          description: Missing parameters.
        '404':
          description: User not found.
        '500':
          description: System error.
      summary: Create a new process proposal.
      tags:
        - processProposal
  /processProposal/getAll:
    get:
      responses:
        '200':
          description: List of all the proposed process.
          schema:
            type: object
            example:
              {
                "message":  "Proposals found.",
                "response": [
                  {
                    "id": 1,
                    "title": "test",
                    "description": "test description",
                    "content": "test content",
                    "date": "2023-01-03T00:00:00.000Z",
                    "user_id": 1,
                    "is_in_process": false
                  }
                ]
              }
        '500':
          description: System error.
      summary: Get all the proposed process.
      tags:
        - processProposal
  /processProposal/delete:
    get:
      parameters:
        - in: query
          name: id
          type: integer
          description: Id of the proposed process to delete.
      responses:
        '200':
          description: process proposal deleted.
        '400':
          description: Missing parameters.
        '404':
          description: Process proposal not found.
        '500':
          description: System error.
      summary: Delete a process proposal.
      tags:
        - processProposal
  /contact/sendEmail:
    get:
      parameters:
        - in: query
          name: email
          type: string
        - in: query
          name: content
          type: string
        - in: query
          name: name
          type: string
      responses:
        '200':
          description: Email send.
        '500':
          description: System error.
      summary: Send an email to the Paperwork development team.
      tags:
        - contact